<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ABCD ERP - Peripherals</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/media.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
    />
  </head>
  <body>
    <!-- Top Bar -->
    <header class="topbar">
      <div class="topbar-left">
        <div class="logo"><a href="../../index.html">ABCD</a></div>
        <button id="hamburger" class="hamburger-btn material-icons">menu</button>
      </div>

      <div class="topbar-right">
        <div class="search-container" id="searchBox" role="search">
          <input
            type="text"
            placeholder="Search peripherals..."
            aria-label="Search peripherals"
            id="peripheralSearch"
          />
          <div class="search-icon-container">
            <button
              type="button"
              id="searchToggle"
              class="material-icons search-icon"
            >
              search
            </button>
          </div>
        </div>
      </div>
    </header>

    <div class="container">
      <!-- Sidebar -->
      <nav class="sidebar show" id="sidebar" aria-label="Main navigation">
        <div class="menu">
          <div class="menu-item">
            <a href="users.html">
              <span class="material-icons">person</span>
              User
            </a>
          </div>

          <div class="menu-item has-submenu">
            <a href="javascript:void(0)" class="submenu-toggle">
              <span class="material-icons">inventory_2</span>
              Inventory
            </a>
            <div class="submenu">
              <a href="inventory.html">Inventory Items</a>
              <a href="accessories.html">Accessories</a>
              <a href="peripherals.html" class="active">Peripherals</a>
            </div>
          </div>

          <div class="menu-item">
            <a href="repair.html">
              <span class="material-icons">build</span>
              Repair
            </a>
          </div>
          <div class="menu-item">
            <a href="upgrade.html">
              <span class="material-icons">upgrade</span>
              Upgrade
            </a>
          </div>
          <div class="menu-item">
            <a href="issueitem.html">
              <span class="material-icons">assignment_returned</span>
              Issue To
            </a>
          </div>
          <div class="menu-item">
            <a href="report.html">
              <span class="material-icons">bar_chart</span>
              Reports
            </a>
          </div>
        </div>

        <div class="sidebar-footer">
          <span class="material-icons">account_circle</span>
          <span>Logged User</span>
        </div>
      </nav>

      <!-- Main Section -->
      <main class="main" id="main-content">
        <div class="page-header">
          <h2>Peripherals Management</h2>
          <button class="btn btn-primary" id="addItemBtn">+ Add Peripheral</button>
        </div>

        <!-- Peripherals Cards -->
        <div class="cards-container" id="cardsContainer">
          <!-- Input Devices -->
          <div class="item-card" data-id="PER001" data-name="Keyboard">
            <img src="../assets/images/keyboard.png" alt="Keyboard" class="card-img" />
            <h3>Keyboard</h3>
            <p>Quantity: 20 / 25</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <div class="item-card" data-id="PER002" data-name="Mouse">
            <img src="../assets/images/mouse.png" alt="Mouse" class="card-img" />
            <h3>Mouse</h3>
            <p>Quantity: 18 / 20</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <div class="item-card" data-id="PER003" data-name="Barcode Scanner">
            <img src="../assets/images/barcode.png" alt="Barcode Scanner" class="card-img" />
            <h3>Barcode Scanner</h3>
            <p>Quantity: 8 / 10</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <div class="item-card" data-id="PER004" data-name="Biometric Scanner">
            <img src="../assets/images/fingerprint.png" alt="Biometric Scanner" class="card-img" />
            <h3>Biometric Scanner</h3>
            <p>Quantity: 5 / 6</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <!-- Output Devices -->
          <div class="item-card" data-id="PER005" data-name="Monitor">
            <img src="../assets/images/monitor.png" alt="Monitor" class="card-img" />
            <h3>Monitor</h3>
            <p>Quantity: 32 / 35</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <div class="item-card" data-id="PER006" data-name="Printer">
            <img src="../assets/images/printer.png" alt="Printer" class="card-img" />
            <h3>Printer</h3>
            <p>Quantity: 12 / 15</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <div class="item-card" data-id="PER007" data-name="Scanner">
            <img src="../assets/images/scanner.png" alt="Scanner" class="card-img" />
            <h3>Scanner</h3>
            <p>Quantity: 9 / 10</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <div class="item-card" data-id="PER008" data-name="Projector">
            <img src="../assets/images/projector.png" alt="Projector" class="card-img" />
            <h3>Projector</h3>
            <p>Quantity: 6 / 8</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <div class="item-card" data-id="PER009" data-name="Speakers">
            <img src="../assets/images/speaker.png" alt="Speakers" class="card-img" />
            <h3>Speakers</h3>
            <p>Quantity: 15 / 20</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <div class="item-card" data-id="PER010" data-name="Headset">
            <img src="../assets/images/headset.png" alt="Headset" class="card-img" />
            <h3>Headset</h3>
            <p>Quantity: 22 / 25</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <div class="item-card" data-id="PER011" data-name="Webcam">
            <img src="../assets/images/webcam.png" alt="Webcam" class="card-img" />
            <h3>Webcam</h3>
            <p>Quantity: 10 / 12</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <!-- Networking -->
          <div class="item-card" data-id="PER012" data-name="Router">
            <img src="../assets/images/router.png" alt="Router" class="card-img" />
            <h3>Router</h3>
            <p>Quantity: 6 / 8</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <div class="item-card" data-id="PER013" data-name="Network Switch">
            <img src="../assets/images/switch.png" alt="Network Switch" class="card-img" />
            <h3>Network Switch</h3>
            <p>Quantity: 8 / 10</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>

          <div class="item-card" data-id="PER014" data-name="Access Point">
            <img src="../assets/images/access-point.png" alt="Access Point" class="card-img" />
            <h3>Access Point</h3>
            <p>Quantity: 4 / 6</p>
            <button class="btn btn-sm btn-primary view-details">View Details</button>
          </div>
        </div>
      </main>

      <!-- Add Peripheral Modal -->
      <div id="addItemModal" class="modal" aria-hidden="true">
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="addItemTitle">
          <span class="close" id="closeItemModal" role="button" aria-label="Close">&times;</span>
          <h2 id="addItemTitle">Add New Peripheral</h2>
          <form id="addItemForm">
            <div class="form-group">
              <label for="itemNameInput">Peripheral Name</label>
              <input type="text" id="itemNameInput" name="itemName" required />
            </div>

            <div class="form-group">
              <label for="itemImage">Peripheral Image</label>
              <input type="file" id="itemImage" name="itemImage" accept="image/*" />
              <div class="image-preview">
                <img id="previewImg" src="" alt="Preview" style="display: none; max-width: 100px; margin-top: 10px" />
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Save</button>
              <button type="button" class="btn btn-secondary" id="cancelItemBtn">Cancel</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- your site-wide script (if any) -->
    <script src="../js/script.js"></script>

    <!-- page-specific behaviors -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // -------------------------
        // Card navigation
        // -------------------------
        const cards = document.querySelectorAll(".item-card");
        cards.forEach((card) => {
          // navigate when whole card clicked
          card.addEventListener("click", (e) => {
            // ignore clicks that came from controls inside card if any (like future dropdowns)
            const ignoreTags = ["BUTTON", "A", "INPUT", "SELECT", "LABEL"];
            if (ignoreTags.includes(e.target.tagName)) return;

            const name = card.getAttribute("data-name") || card.querySelector("h3")?.textContent?.trim();
            if (!name) return;
            const url = `peripheral-details.html?item=${encodeURIComponent(name)}`;
            window.location.href = url;
          });

          // also attach to the small 'View Details' button so click works even when user clicks that
          const btn = card.querySelector(".view-details");
          if (btn) {
            btn.addEventListener("click", (ev) => {
              ev.stopPropagation(); // prevent double handling
              const name = card.getAttribute("data-name") || card.querySelector("h3")?.textContent?.trim();
              if (!name) return;
              const url = `peripheral-details.html?item=${encodeURIComponent(name)}`;
              window.location.href = url;
            });
          }
        });

        // -------------------------
        // Simple client-side search for cards (optional)
        // -------------------------
        const searchInput = document.getElementById("peripheralSearch");
        if (searchInput) {
          searchInput.addEventListener("input", () => {
            const q = searchInput.value.trim().toLowerCase();
            cards.forEach((card) => {
              const name = (card.getAttribute("data-name") || card.querySelector("h3")?.textContent || "").toLowerCase();
              const txt = (card.textContent || "").toLowerCase();
              const show = q === "" || name.includes(q) || txt.includes(q);
              card.style.display = show ? "" : "none";
            });
          });
        }

        // -------------------------
        // Modal: Add Peripheral
        // -------------------------
        const addItemBtn = document.getElementById("addItemBtn");
        const modal = document.getElementById("addItemModal");
        const closeBtn = document.getElementById("closeItemModal");
        const cancelBtn = document.getElementById("cancelItemBtn");
        const itemForm = document.getElementById("addItemForm");
        const itemImage = document.getElementById("itemImage");
        const previewImg = document.getElementById("previewImg");
        const itemNameInput = document.getElementById("itemNameInput");

        function openModal() {
          modal.style.display = "block";
          modal.setAttribute("aria-hidden", "false");
          itemNameInput.focus();
        }
        function closeModal() {
          modal.style.display = "none";
          modal.setAttribute("aria-hidden", "true");
          itemForm.reset();
          previewImg.style.display = "none";
        }

        addItemBtn.addEventListener("click", openModal);
        closeBtn.addEventListener("click", closeModal);
        cancelBtn.addEventListener("click", closeModal);
        window.addEventListener("click", (e) => {
          if (e.target === modal) closeModal();
        });
        window.addEventListener("keydown", (e) => {
          if (e.key === "Escape" && modal.style.display === "block") closeModal();
        });

        itemImage.addEventListener("change", (e) => {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = () => {
              previewImg.src = reader.result;
              previewImg.style.display = "block";
            };
            reader.readAsDataURL(file);
          } else {
            previewImg.style.display = "none";
            previewImg.src = "";
          }
        });

        itemForm.addEventListener("submit", (e) => {
          e.preventDefault();
          const name = itemNameInput.value.trim();
          if (!name) {
            alert("Please enter a peripheral name.");
            itemNameInput.focus();
            return;
          }

          // For now just show a success message and close modal.
          // Later: send to backend and update the cards list dynamically.
          alert(`Peripheral added: ${name}`);

          closeModal();
        });

        // // -------------------------
        // // Sidebar hamburger toggle (simple)
        // // -------------------------
        // const hamburger = document.getElementById("hamburger");
        // const sidebar = document.getElementById("sidebar");
        // if (hamburger && sidebar) {
        //   hamburger.addEventListener("click", () => {
        //     sidebar.classList.toggle("hide");
        //   });
        // }
      });
    </script>
  </body>
</html>
